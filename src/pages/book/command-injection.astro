---
import { STORE, buildBookPricing } from '~/config.mjs';

import { getCanonical, getHomePermalink } from '~/utils/permalinks';
import Layout from '~/layouts/BooksLayout.astro';
import Hero from '~/components/widgets/CommandInjection/BooksHero.astro';
import Pricing1Column from '~/components/widgets/CommandInjection/Pricing1Column.astro';
import BookFeatures from '~/components/widgets/CommandInjection/BookFeatures.astro';
import BookAuthor from '~/components/widgets/CommandInjection/BookAuthor.astro';
import ScaleUpSecurity from '~/components/widgets/CommandInjection/ScaleUpSecurity.astro';
import FAQ from '~/components/widgets/CommandInjection/FAQ.astro';
import Stats from '~/components/widgets/CommandInjection/Stats.astro';
import CallToAction from '~/components/widgets/CommandInjection/CallToAction.astro';
import TestimonialHeroBlock from '~/components/widgets/CommandInjection/TestimonialHeroBlock.astro';
import TestimonialCollection from '~/components/widgets/CommandInjection/TestimonialCollection.astro';
import BookSampleCTA from '~/components/widgets/CommandInjection/BookSampleCTA.astro';
import PagesGallery from '~/components/widgets/CommandInjection/PagesGallery.astro';
import BookModules from '~/components/widgets/CommandInjection/BookModules.astro';

import ogImage from '~/assets/images/command-injection-book-og-v1.png';

const meta = {
	title: 'Node.js Secure Coding: Defending Against Command Injection Vulnerabilities',
	description: `Discover the best practices for Node.js security and secure coding. Learn how to identify and prevent command injection vulnerabilities with expert Liran Tal.`,
	canonical: getCanonical(getHomePermalink()),
	image: ogImage,
};

const discountCode = Astro.url.searchParams.get('discount_code') || 'default';
const bundlePricing = buildBookPricing({discountCode: '', bookId: 'bundle'});
const CommandInjectionPricing = buildBookPricing({discountCode, bookId: 'CommandInjection'});

// This page route is rendered on-demand on the server
export const prerender = false
---

<Layout {meta}>
	<Hero
		title="Node.js Secure Coding:"
		subtitle="Defending Against Command Injection Vulnerabilities"

		bundlePricing={bundlePricing}
		bookPricing={CommandInjectionPricing}
	/>

	<PagesGallery />

	<Stats />

	<TestimonialCollection />

	<BookModules />

	<ScaleUpSecurity />

	<TestimonialHeroBlock />

	<BookFeatures />

	<Pricing1Column />

	<BookSampleCTA />

	<!-- <Steps /> -->
	<!-- <Features3 /> -->
	<!-- <Features /> -->

	<BookAuthor />

	<FAQ />
	
	<CallToAction
		priceBeforeDiscount={CommandInjectionPricing.priceBeforeDiscount}
		priceAfterDiscount={CommandInjectionPricing.priceAfterDiscount}
		linkBuy={CommandInjectionPricing.linkBuy}
	/>
</Layout>
