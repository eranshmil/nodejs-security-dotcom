---
import { buildBookPricing, STORE, SITE } from '~/config.mjs';

import { getCanonical, getHomePermalink } from '~/utils/permalinks';
import Layout from '~/layouts/BooksLayout.astro';


import BookAuthor from '~/components/widgets/CommandInjection/BookAuthor.astro';
import ScaleUpSecurity from '~/components/widgets/CommandInjection/ScaleUpSecurity.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import TestimonialHeroBlock from '~/components/widgets/CommandInjection/TestimonialHeroBlock.astro';
import TestimonialCollection from '~/components/widgets/CommandInjection/TestimonialCollection.astro';
import DeveloperCompanies from '~/components/widgets/DeveloperCompanies.astro';
import HeroBookBundle from '~/components/widgets/HeroBookBundle.astro';
import BookModulesCommandInjectionHighLevel from '~/components/widgets/BookModulesCommandInjectionHighLevel.astro';
import BookModulesPathTraversalHighLevel from '~/components/widgets/BookModulesPathTraversalHighLevel.astro';
import BookCoverHeroCommandInjection from '~/components/widgets/CommandInjection/BookCoverHeroCommandInjection.astro';
import BookCoverHeroPathTraversal from '~/components/widgets/PathTraversal/BookCoverHeroPathTraversal.astro';

const meta = {
	title: SITE.title,
	description: SITE.description,
	canonical: getCanonical(getHomePermalink()),
};

const discountCode = 'default';
const bundlePricing = buildBookPricing({discountCode: '', bookId: 'bundle'});
const CommandInjectionPricing = buildBookPricing({discountCode, bookId: 'CommandInjection'});
const PathTraversalPricing = buildBookPricing({discountCode, bookId: 'PathTraversal'});
---

<Layout {meta}>

	<HeroBookBundle
		discountPercentage={bundlePricing.discountPercentage}
		linkBuy={bundlePricing.linkBuy}
		priceBeforeDiscount={bundlePricing.priceBeforeDiscount}
		priceAfterDiscount={bundlePricing.priceAfterDiscount}
	/>

	<!-- <Hero
		_pretitle="Skill up on"
		title="Node.js Secure Coding"
		subtitle=""
		CTA2={{
			// text: 'Get the book, start coding securely',
			text: 'Buy the book',
			// text: 'Get started',
			href: STORE.bookBuyLink,
			hrefDarkMode: STORE.bookBuyLinkDarkMode,
			priceOld: '$57.60',
			priceNew: '$40.32',
			// priceNew: '$28.80',
		}}
		BOOK_COMMAND_INJECTION={{
			href: STORE.CommandInjection.bookBuyLinkDarkMode,
			priceOld: '$57.60',
			priceNew: '$40.32',
			// priceNew: '$28.80',
		}}
		BOOK_PATH_TRAVERSAL={{
			href: STORE.PathTraversal.buyBookLink,
			priceOld: '$57.60',
			priceNew: '$40.32',
			// priceNew: '$28.80',
		}}
	/> -->

	<BookAuthor />

	<BookCoverHeroCommandInjection
		linkLearnMore={"/book/command-injection"}
		discountPercentage={CommandInjectionPricing.discountPercentage}
		linkBuy={CommandInjectionPricing.linkBuy}
		priceBeforeDiscount={CommandInjectionPricing.priceBeforeDiscount}
		priceAfterDiscount={CommandInjectionPricing.priceAfterDiscount}
	/>

	<DeveloperCompanies />

	<BookCoverHeroPathTraversal
		linkLearnMore={"/book/path-traversal"}
		discountPercentage={PathTraversalPricing.discountPercentage}
		linkBuy={PathTraversalPricing.linkBuy}
		priceBeforeDiscount={PathTraversalPricing.priceBeforeDiscount}
		priceAfterDiscount={PathTraversalPricing.priceAfterDiscount}
	/>
	
	<div class="mx-auto text-center -mt-28 px-16 md:px-4">
		<p class="mt-2 text-normal font-light text-gray-500 dark:text-gray-400">
			<span class="bg-green-100 text-green-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300">
				Tip:
			</span>
			 get 2 secure coding books bundle at <code>{bundlePricing.priceAfterDiscount}</code> and save <code>{bundlePricing.discountPercentage}%</code>
		<span class="block"></span>
		<a
			class="mt-2 text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-normal rounded-lg text-sm px-4 py-1.5 text-center inline-flex items-center me-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800"
			href={'#'}
			target="_blank"
			rel="noopener"
		>
			<svg class="w-2 h-2 me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 18 21">
				<path d="M15 12a1 1 0 0 0 .962-.726l2-7A1 1 0 0 0 17 3H3.77L3.175.745A1 1 0 0 0 2.208 0H1a1 1 0 0 0 0 2h.438l.6 2.255v.019l2 7 .746 2.986A3 3 0 1 0 9 17a2.966 2.966 0 0 0-.184-1h2.368c-.118.32-.18.659-.184 1a3 3 0 1 0 3-3H6.78l-.5-2H15Z"/>
			</svg>
			Buy Bundle
		</a>
		</p>
	</div>


	<TestimonialCollection />

	<BookModulesCommandInjectionHighLevel />

	<BookModulesPathTraversalHighLevel />

	<ScaleUpSecurity />

	<TestimonialHeroBlock />

	<CallToAction />
</Layout>
